<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Iniciar sesi칩n en DiagnosLab - Accede a tu cuenta de usuario" />
  <meta name="author" content="DiagnosLab" />
  <title>Iniciar Sesi칩n - DiagnosLab</title>

  <link rel="stylesheet" href="../css/optimized.css" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
  <script src="https://cdn.jsdelivr.net/npm/toastify-js" defer></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11" defer></script>
  <script src="https://unpkg.com/vue@3/dist/vue.global.prod.js" defer></script>
  <script src="../js/utils.js" defer></script>
  <script src="../js/auth-manager.js" defer></script>
  <script src="../js/cart-manager.js" defer></script>
  <script src="../js/main.js" defer></script>
</head>

<body>
  <div>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
      <div class="container">
        <a class="navbar-brand d-flex align-items-center gap-2" href="../index.html">
          <img src="../acces/logo.png" alt="DiagnosLab" height="36" />
          <span class="fw-semibold">DiagnosLab</span>
        </a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarDiag"
          aria-controls="navbarDiag" aria-expanded="false" aria-label="Mostrar men칰">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarDiag">
          <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
            <li class="nav-item">
              <a class="nav-link" href="../index.html">Inicio</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="./productos.html">Productos</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="./servicios.html">Servicios</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="./nosotros.html">Nosotros</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="./contacto.html">Contacto</a>
            </li>
            <li class="nav-item" id="loginLink">
              <a class="nav-link active" href="./login.html">Iniciar Sesi칩n</a>
            </li>
            <li class="nav-item" id="registerLink">
              <a class="nav-link" href="./registro.html">Registro</a>
            </li>
            <li class="nav-item" id="userMenu" style="display: none;">
              <div id="userInfo"></div>
            </li>
            <li class="nav-item position-relative">
              <a class="nav-link" href="./carrito.html">游
                <span id="cartCount" class="badge bg-danger position-absolute translate-middle p-1"
                  style="top: 0; right: 0; font-size: 0.7rem; display: none">0</span>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </nav>

    <!-- Header -->
    <header class="text-white text-center py-5" style="
          background: linear-gradient(270deg, #4dabf7, #0d6efd, #004085);
          background-size: 600% 600%;
          animation: heroGradient 15s ease infinite;
        ">
      <div class="container">
        <h1 class="display-6 fw-bold mb-2">Iniciar Sesi칩n</h1>
        <p class="mb-0">Accede a tu cuenta de DiagnosLab</p>
      </div>
    </header>

    <!-- Main Content -->
    <main class="py-5">
      <div class="container">
        <div class="row justify-content-center">
          <div class="col-md-6 col-lg-5">
            <div class="card shadow-lg border-0">
              <div class="card-body p-5">
                <div class="text-center mb-4">
                  <i class="bi bi-person-circle text-primary" style="font-size: 3rem;"></i>
                  <h3 class="mt-3 mb-1">춰Bienvenido de vuelta!</h3>
                  <p class="text-muted">Ingresa tus datos para acceder a tu cuenta</p>
                </div>

                <!-- Login Form -->
                <form id="loginForm" novalidate>
                  <div class="mb-3">
                    <label for="loginEmail" class="form-label">Email</label>
                    <div class="input-group">
                      <span class="input-group-text"><i class="bi bi-envelope"></i></span>
                      <input type="email" class="form-control" id="loginEmail" 
                             placeholder="tu@email.com" required>
                    </div>
                    <div class="invalid-feedback">
                      Por favor ingresa un email v치lido.
                    </div>
                  </div>

                  <div class="mb-3">
                    <label for="loginPassword" class="form-label">Contrase침a</label>
                    <div class="input-group">
                      <span class="input-group-text"><i class="bi bi-lock"></i></span>
                      <input type="password" class="form-control" id="loginPassword" 
                             placeholder="Tu contrase침a" required>
                      <button class="btn btn-outline-secondary" type="button" id="togglePassword">
                        <i class="bi bi-eye"></i>
                      </button>
                    </div>
                    <div class="invalid-feedback">
                      Por favor ingresa tu contrase침a.
                    </div>
                  </div>

                  <div class="mb-3 form-check">
                    <input type="checkbox" class="form-check-input" id="rememberMe">
                    <label class="form-check-label" for="rememberMe">
                      Recordarme
                    </label>
                  </div>

                  <div class="d-grid mb-3">
                    <button type="submit" class="btn btn-primary btn-lg">
                      <i class="bi bi-box-arrow-in-right me-2"></i>
                      Iniciar Sesi칩n
                    </button>
                  </div>

                  <div class="text-center">
                    <a href="#" class="text-decoration-none" id="forgotPassword">
                      쯆lvidaste tu contrase침a?
                    </a>
                  </div>
                </form>

                <hr class="my-4">

                <div class="text-center">
                  <p class="mb-0">쯅o tienes cuenta?</p>
                  <a href="./registro.html" class="btn btn-outline-primary">
                    <i class="bi bi-person-plus me-2"></i>
                    Crear cuenta nueva
                  </a>
                </div>
              </div>
            </div>

            <!-- Demo Users -->
            <div class="card mt-4 border-0 bg-light">
              <div class="card-body p-4">
                <h6 class="card-title text-center mb-3">
                  <i class="bi bi-info-circle me-2"></i>
                  Usuarios de prueba
                </h6>
                <div class="row g-2">
                  <div class="col-6">
                    <button class="btn btn-sm btn-outline-secondary w-100" onclick="fillDemoUser('admin@diagnoslab.com', 'admin123')">
                      Admin
                    </button>
                  </div>
                  <div class="col-6">
                    <button class="btn btn-sm btn-outline-secondary w-100" onclick="fillDemoUser('usuario@diagnoslab.com', 'usuario123')">
                      Usuario
                    </button>
                  </div>
                </div>
                <small class="text-muted d-block mt-2 text-center">
                  Usa estos datos para probar el sistema
                </small>
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>

    <!-- Footer -->
    <footer class="footer-diag text-white text-center py-4"
      style="background: linear-gradient(270deg, #4dabf7, #0d6efd)">
      <div class="container">
        <p class="mb-0">
          춸 2025 DiagnosLab - Todos los derechos reservados. by Fer Ropelato
        </p>
        <div class="mt-2">
          <a href="https://www.facebook.com" class="text-white me-3"><i class="bi bi-facebook"></i></a>
          <a href="https://www.instagram.com" class="text-white me-3"><i class="bi bi-instagram"></i></a>
          <a href="https://www.whatsapp.com" class="text-white"><i class="bi bi-whatsapp"></i></a>
        </div>
      </div>
    </footer>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  
  <script>
    // Funci칩n para llenar datos de demo
    function fillDemoUser(email, password) {
      document.getElementById('loginEmail').value = email;
      document.getElementById('loginPassword').value = password;
    }

    // Toggle password visibility
    document.getElementById('togglePassword').addEventListener('click', function() {
      const passwordInput = document.getElementById('loginPassword');
      const icon = this.querySelector('i');
      
      if (passwordInput.type === 'password') {
        passwordInput.type = 'text';
        icon.classList.remove('bi-eye');
        icon.classList.add('bi-eye-slash');
      } else {
        passwordInput.type = 'password';
        icon.classList.remove('bi-eye-slash');
        icon.classList.add('bi-eye');
      }
    });

    // Precargar datos del formulario si est치n disponibles
    function preloadFormData() {
      const savedEmail = localStorage.getItem('dlab_saved_email');
      const rememberMe = localStorage.getItem('dlab_remember_me') === 'true';
      
      if (savedEmail && rememberMe) {
        document.getElementById('loginEmail').value = savedEmail;
        document.getElementById('rememberMe').checked = true;
      }
    }

    // Guardar datos del formulario
    function saveFormData() {
      const email = document.getElementById('loginEmail').value;
      const rememberMe = document.getElementById('rememberMe').checked;
      
      if (rememberMe && email) {
        localStorage.setItem('dlab_saved_email', email);
        localStorage.setItem('dlab_remember_me', 'true');
      } else {
        localStorage.removeItem('dlab_saved_email');
        localStorage.removeItem('dlab_remember_me');
      }
    }

    // Crear usuarios de demo si no existen
    document.addEventListener('DOMContentLoaded', function() {
      preloadFormData();
      
      const users = window.StorageUtils.get(window.SITE_CONFIG.storageKeys.users, []);
      
      // Crear usuario admin si no existe
      if (!users.find(u => u.email === 'admin@diagnoslab.com')) {
        users.push({
          id: '1',
          nombre: 'Admin',
          apellido: 'DiagnosLab',
          email: 'admin@diagnoslab.com',
          telefono: '+54 9 11 1234-5678',
          direccion: 'Av. Principal 123, Buenos Aires',
          pass: 'admin123',
          createdAt: new Date().toISOString(),
          lastLogin: null,
          orders: []
        });
      }

      // Crear usuario demo si no existe
      if (!users.find(u => u.email === 'usuario@diagnoslab.com')) {
        users.push({
          id: '2',
          nombre: 'Usuario',
          apellido: 'Demo',
          email: 'usuario@diagnoslab.com',
          telefono: '+54 9 11 8765-4321',
          direccion: 'Calle Demo 456, CABA',
          pass: 'usuario123',
          createdAt: new Date().toISOString(),
          lastLogin: null,
          orders: []
        });
      }

      window.StorageUtils.set(window.SITE_CONFIG.storageKeys.users, users);
    });

    // Event listener para recordar datos
    document.getElementById('rememberMe').addEventListener('change', saveFormData);
    document.getElementById('loginEmail').addEventListener('blur', saveFormData);
  </script>
</body>
</html>
