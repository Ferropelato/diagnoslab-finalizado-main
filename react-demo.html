<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="DiagnosLab - Demo React Components" />
    <title>React Demo | DiagnosLab</title>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="css/optimized.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" />
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel Standalone para transpilar JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>
<body>
    <div id="root"></div>
    
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Componentes React -->
    <script type="text/babel">
        const { useState, useEffect } = React;
        
        // CartWidget Component
        const CartWidget = ({ itemCount = 0 }) => {
            return (
                <div className="position-relative">
                    <a className="nav-link" href="./pages/carrito.html">
                        游
                        {itemCount > 0 && (
                            <span 
                                className="badge bg-danger position-absolute translate-middle p-1"
                                style={{
                                    top: 0,
                                    right: 0,
                                    fontSize: '0.7rem',
                                    display: 'inline-block'
                                }}
                            >
                                {itemCount > 99 ? '99+' : itemCount}
                            </span>
                        )}
                    </a>
                </div>
            );
        };
        
        // Navbar Component
        const Navbar = ({ welcomeMessage = 'Bienvenido a DiagnosLab', cartCount = 0 }) => {
            const navLinks = [
                { path: './index.html', label: 'Inicio' },
                { path: './pages/productos.html', label: 'Productos' },
                { path: './pages/servicios.html', label: 'Servicios' },
                { path: './pages/nosotros.html', label: 'Nosotros' },
                { path: './pages/contacto.html', label: 'Contacto' },
                { path: './pages/login.html', label: 'Iniciar Sesi칩n' },
                { path: './pages/registro.html', label: 'Registro' },
            ];
            
            return (
                <header>
                    <nav className="navbar navbar-expand-lg navbar-dark bg-primary">
                        <div className="container">
                            <a className="navbar-brand d-flex align-items-center gap-2" href="index.html">
                                <img src="./acces/logo.png" alt="DiagnosLab" height="36" />
                                <span className="fw-semibold">DiagnosLab</span>
                            </a>
                            <button 
                                className="navbar-toggler" 
                                type="button" 
                                data-bs-toggle="collapse"
                                data-bs-target="#navbarDiagnosLab" 
                                aria-controls="navbarDiagnosLab" 
                                aria-expanded="false"
                                aria-label="Men칰"
                            >
                                <span className="navbar-toggler-icon"></span>
                            </button>
                            <div className="collapse navbar-collapse" id="navbarDiagnosLab">
                                <ul className="navbar-nav ms-auto mb-2 mb-lg-0">
                                    {navLinks.map((link, index) => (
                                        <li key={index} className="nav-item">
                                            <a className="nav-link" href={link.path}>
                                                {link.label}
                                            </a>
                                        </li>
                                    ))}
                                    <li className="nav-item">
                                        <CartWidget itemCount={cartCount} />
                                    </li>
                                    <li className="nav-item">
                                        <span id="liveClock" className="nav-link small text-white-50 d-none d-lg-inline">
                                            --:--:--
                                        </span>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </nav>
                    {welcomeMessage && (
                        <div className="alert alert-info mb-0 text-center" role="alert">
                            {welcomeMessage}
                        </div>
                    )}
                </header>
            );
        };
        
        // ItemListContainer Component
        const ItemListContainer = ({ greeting = 'Bienvenido a nuestro cat치logo de productos' }) => {
            return (
                <div className="container my-5">
                    <div className="text-center">
                        <h2 className="h3 mb-4">{greeting}</h2>
                        <p className="lead text-muted">
                            Explora nuestra amplia gama de productos para an치lisis cl칤nicos
                        </p>
                    </div>
                </div>
            );
        };
        
        // App Component
        const App = () => {
            const [cartCount, setCartCount] = useState(0);
            
            useEffect(() => {
                // Funci칩n para actualizar el conteo del carrito
                const updateCartCount = () => {
                    try {
                        if (window.cartManager) {
                            const { totalItems } = window.cartManager.getTotals();
                            setCartCount(totalItems);
                        } else if (window.cart && Array.isArray(window.cart)) {
                            const total = window.cart.reduce((acc, item) => acc + (item.qty || 0), 0);
                            setCartCount(total);
                        }
                    } catch (error) {
                        console.log('Cart not initialized yet');
                    }
                };
                
                // Actualizar al cargar
                updateCartCount();
                
                // Polling para actualizar el conteo
                const interval = setInterval(updateCartCount, 1000);
                
                return () => clearInterval(interval);
            }, []);
            
            return (
                <div>
                    <Navbar 
                        welcomeMessage="춰Bienvenido a DiagnosLab! Tu laboratorio de confianza"
                        cartCount={cartCount}
                    />
                    <main>
                        <ItemListContainer greeting="Explora nuestros productos de laboratorio" />
                    </main>
                </div>
            );
        };
        
        // Renderizar la aplicaci칩n
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>

